<!-- dryver_django\templates\index.html -->
{% extends 'base.html' %}
{% load static %}

{% block sheets %}
{% comment %}
<!-- <link
  href="{% static 'css/arcgis_map.css' %}"
  rel="stylesheet"
> -->
{% endcomment %}
{% endblock %}

{% block content %}
<div class="row no-gutters w-100 h-100 mh-100" id="map-container">
  <div class="col d-flex flex-column mh-100">    
    <div class="tab-content d-flex w-100 h-100 mh-100">
      <div class="tab-pane active w-100 h-100 mh-100" id="map-pane" role="tabpanel">
        {% include 'map/map.html' %}
      </div>
      <div class="tab-pane w-100 h-100 mh-100" id="windy-pane" role="tabpanel">
        <iframe src="{% static 'windy.html' %}" class="w-100 h-100 mh-100"></iframe>
      </div>
    </div>
  </div>
</div>
<!-- Loading in Esri Widgets -->
<div class="d-none">
  {% include 'map/topbar.html' %}
</div>
{% include 'sidebar.html' %}
{% endblock %}

{% block scripts %}
<script
  type="text/javascript"
  src="{% static 'js/arcgis_map.js' %}"
></script>
<!-- Using this because the classes in above button don't let it happen -->
<script type="text/javascript">
  // Bootstrap's sidebar navigation behaviour
  // Whenever the user clicks on any of the first three buttons
  // It should always switch back to map view since those tools
  // Within its respective tab-pane is for the map
  $('#sidebar-nav a').on('click', function (e) {
    e.preventDefault()
    $('#main-pane-nav a#list-map-list').tab('show')
    if ($(this).hasClass('active')) {
      if ($('div#sidebar-content.col').hasClass('d-none')) {
        $('div#sidebar-content.col').removeClass('d-none')
        $('div#sidebar-content.col').addClass('d-flex')
      } else {
        $('div#sidebar-content.col').addClass('d-none')
        $('div#sidebar-content.col').removeClass('d-flex')
      }
    } else {
      if ($('div#sidebar-content.col').hasClass('d-none')) {
        $('div#sidebar-content.col').removeClass('d-none')
        $('div#sidebar-content.col').addClass('d-flex')
      }
    }
  })

  $('#main-pane-nav a').on('click', function (e) {
    e.preventDefault()
    if ($(this).attr('id') === 'list-wind-list') {
      $('div#sidebar-content.col').addClass('d-none')
      $('div#sidebar-content.col').removeClass('d-flex')
    }
  })

  // Tab 3 collapse behaviour
  $('#expand-all-headings button').on('click', function (e) {
    e.preventDefault()
    if ($(this).hasClass('collapsed')) {
      $('.collapse.expand-all-cards').collapse('show')
      $(this).removeClass('collapsed')
    } else {
      $('.collapse.expand-all-cards').collapse('hide')
      $(this).addClass('collapsed')
    }
  })

  tippy('#list-home-list', {
    content: 'Jump to any location (Latitude/Longitude) on the map',
    size: 'large',
    placement: 'right',
  })

  tippy('#list-datasets-list', {
    content: 'Datasets',
    size: 'large',
    placement: 'right',
  })

  tippy('#list-dryver-list', {
    content: 'DryVER: Dry Valley Ecosystem Resilience',
    size: 'large',
    placement: 'right',
  })

  tippy('#list-wind-list', {
    content: 'Check Windy Weather',
    size: 'large',
    placement: 'right',
  })

  tippy('#list-signout-list', {
    content: 'Sign Out',
    size: 'large',
    placement: 'right',
  })
</script>
{% endblock %}
